<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Fisher&#39;s blog</title>
  
  <subtitle>OIer</subtitle>
  <link href="https://gzezfisher.top/atom.xml" rel="self"/>
  
  <link href="https://gzezfisher.top/"/>
  <updated>2022-01-29T02:20:05.222Z</updated>
  <id>https://gzezfisher.top/</id>
  
  <author>
    <name>Fisher Cai</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>CF1039D You Are Given a Tree</title>
    <link href="https://gzezfisher.top/2022/01/29/cf1039d/"/>
    <id>https://gzezfisher.top/2022/01/29/cf1039d/</id>
    <published>2022-01-29T01:44:24.000Z</published>
    <updated>2022-01-29T02:20:05.222Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>给定一棵有 $n$ 个节点的树. 对于满足 $1\le k\le n$ 的每一个 $k$，把树分成若干条包含 $k$ 个顶点的链，其中每个点最多属于一条链，问最多能分得几条链.</p><p>$n\le 10^5$<br><span id="more"></span></p><h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>考虑 $k$ 固定时怎么做</p><p>我们自下而上贪心，对于一个点，如果在它的子树内有一条经过该点且不经过以被使用点的链，那么我们就将这条链计入答案并将该点标记为使用过</p><p>简单证明一下：<br>对于点 $u$ 满足在其子树内有一条经过该点且不经过以被使用点的链，如果这条链不计入答案，而是选取一条经过 $u$ 的但不完全在 $u$ 子树中的链，这样划分的链数不会增加，反而会占用这条链在点 $u$ 子树外的点<br>因此，按照上述方法贪心是最优的</p><p>令 $f_i$ 表示 $k=i$ 时的答案，显然有 $f_i\le\lfloor\frac{n}{i}\rfloor$</p><p>类似除法分块，$f_i$ 一共只有 $\mathcal{O}(\sqrt{n})$ 种取值<br>证明如下：</p><ol><li>$i\le \sqrt{n}$<br>显然只有不超过 $\sqrt{n}$ 种取值</li><li>$i&gt;\sqrt{n}$<br>$f_i&lt;\lfloor\frac{n}{sqrt{n}}\rfloor=\sqrt{n}$<br>显然也只有不超过 $\sqrt{n}$ 种取值</li></ol><p>因此我们对于每一种取值二分右端点，时间复杂度为 $\mathcal{O}(n\sqrt{n}\log n)$，不足以通过此题</p><p>观察到前几种取值比较密集，对每种取值二分是很浪费的，考虑对前 $T$ 项直接暴力，只对后面的 $\mathcal{O}(\frac{n}{T})$ 种取值二分</p><p>时间复杂度为 $\mathcal{O}(nT+\frac{n}{T}\log n)$，$T$ 取 $\sqrt{n\log n}$ 时有最优复杂度 $\mathcal{O}(n\sqrt{n\log n})$</p><h2 id="细节"><a href="#细节" class="headerlink" title="细节"></a>细节</h2><p>实现的时候注意常数，特别是不要每次贪心都dfs一遍，推荐直接在dfs序上做</p><p>代码 <a href="https://codeforces.com/contest/1039/submission/144337474">codeforces submission 144337474</a></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;题意&quot;&gt;&lt;a href=&quot;#题意&quot; class=&quot;headerlink&quot; title=&quot;题意&quot;&gt;&lt;/a&gt;题意&lt;/h2&gt;&lt;p&gt;给定一棵有 $n$ 个节点的树. 对于满足 $1\le k\le n$ 的每一个 $k$，把树分成若干条包含 $k$ 个顶点的链，其中每个点最多属于一条链，问最多能分得几条链.&lt;/p&gt;
&lt;p&gt;$n\le 10^5$&lt;br&gt;</summary>
    
    
    
    <category term="根号算法" scheme="https://gzezfisher.top/categories/%E6%A0%B9%E5%8F%B7%E7%AE%97%E6%B3%95/"/>
    
    
    <category term="贪心" scheme="https://gzezfisher.top/tags/%E8%B4%AA%E5%BF%83/"/>
    
    <category term="二分" scheme="https://gzezfisher.top/tags/%E4%BA%8C%E5%88%86/"/>
    
    <category term="除法分块" scheme="https://gzezfisher.top/tags/%E9%99%A4%E6%B3%95%E5%88%86%E5%9D%97/"/>
    
    <category term="根号分治" scheme="https://gzezfisher.top/tags/%E6%A0%B9%E5%8F%B7%E5%88%86%E6%B2%BB/"/>
    
  </entry>
  
  <entry>
    <title>CF587F Duff is Mad</title>
    <link href="https://gzezfisher.top/2022/01/28/cf587f/"/>
    <id>https://gzezfisher.top/2022/01/28/cf587f/</id>
    <published>2022-01-28T12:34:33.000Z</published>
    <updated>2022-01-29T01:35:27.723Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>给定 $n$ 个字符串 $S_{1…n}$.<br>定义 $\text{occur}(t, s)$ 为 字符串 $t$ 在字符串 $s$ 中的出现次数. 有 $q$ 次询问，每次给出 $l$，$r$ 和 $k$，输出 $\sum\limits_{l\le i\le r}\text{occur}(s_i, s_k)$.</p><p>$n,k,\sum |s_i|\le 10^5$<br><span id="more"></span></p><h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>我们对所有串建立fail树</p><p>令 $p_{i,j}$ 表示串 $s_i$ 的前 $j$ 个字符在AC自动机上对应点的编号，$end_{i}$ 表示串 $s_i$ 在AC自动机上对应点的编号<br>有 </p><script type="math/tex; mode=display">\sum_{l\le i\le r}\text{occur}(s_i, s_k)=\sum_{l\le i\le r}\sum_{1\le j\le \text{size}_k}\text{isanc}(end_{i}, p_{k, j})</script><p>其中 $\text{isanc}(x, y)$ 表示在fail树上 $x$ 是否为 $y$ 的祖先</p><p>看到 $\sum |s_i|\le 10^5$ 这条限制，容易想到对于 $|s_k|$ 根号分治</p><p>令 $M=\sum |s_i|$</p><ol><li>$|s_k|&lt;=T$<br>容易得到一种做法，$\forall l\le i\le r$，对所有以 $end_i$ 为根的子树的所有点加1，然后查询所有 $p_{k,i}$ 点上的值之和<br>把每个询问差分为成 $[1, l-1]$ 和 $[1, r]$ 两个区间，然后离线下来按右端点排序，维护区间修改单点查询<br>树状数组可以做到 $\mathcal{O}(qT\log M+n\log M)$，当然更快的做法是分块的 $\mathcal{O}(qT+n\sqrt{M})$</li><li>$|s_k|&gt;T$<br>满足这个条件的 $k$ 数量是 $\mathcal{O}(\frac{M}{T})$ 级别的，因此我们考虑对所有的 $k$ 预处理<br>考虑另一种做法，把所有 $p_{k,i}$ 标上1，然后查询 $\forall l\le i\le r$，$end_i$ 子树和之和<br>预处理时我们对 $end_i$ 的子树和做前缀和，询问的差分即可<br>$\mathcal{O}(q+\frac{M}{T}\times n)$</li></ol><p>选择一个合适的 $T$，我们视 $n$，$M$ 和 $q$ 为同阶，$T$ 取 $\sqrt{M}$ 即可<br>复杂度可以简单地认为是 $\mathcal{O}(n\sqrt{M})$</p><p>代码 <a href="https://codeforces.com/contest/587/submission/144319232">codeforces submission 144319232</a></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;题意&quot;&gt;&lt;a href=&quot;#题意&quot; class=&quot;headerlink&quot; title=&quot;题意&quot;&gt;&lt;/a&gt;题意&lt;/h2&gt;&lt;p&gt;给定 $n$ 个字符串 $S_{1…n}$.&lt;br&gt;定义 $\text{occur}(t, s)$ 为 字符串 $t$ 在字符串 $s$ 中的出现次数. 有 $q$ 次询问，每次给出 $l$，$r$ 和 $k$，输出 $\sum\limits_{l\le i\le r}\text{occur}(s_i, s_k)$.&lt;/p&gt;
&lt;p&gt;$n,k,\sum |s_i|\le 10^5$&lt;br&gt;</summary>
    
    
    
    <category term="根号算法" scheme="https://gzezfisher.top/categories/%E6%A0%B9%E5%8F%B7%E7%AE%97%E6%B3%95/"/>
    
    <category term="字符串" scheme="https://gzezfisher.top/categories/%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    
    <category term="AC自动机" scheme="https://gzezfisher.top/categories/%E5%AD%97%E7%AC%A6%E4%B8%B2/AC%E8%87%AA%E5%8A%A8%E6%9C%BA/"/>
    
    
    <category term="根号分治" scheme="https://gzezfisher.top/tags/%E6%A0%B9%E5%8F%B7%E5%88%86%E6%B2%BB/"/>
    
    <category term="分块" scheme="https://gzezfisher.top/tags/%E5%88%86%E5%9D%97/"/>
    
    <category term="AC自动机" scheme="https://gzezfisher.top/tags/AC%E8%87%AA%E5%8A%A8%E6%9C%BA/"/>
    
    <category term="fail树" scheme="https://gzezfisher.top/tags/fail%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>CF1118F2 Tree Cutting (Hard Version)</title>
    <link href="https://gzezfisher.top/2022/01/27/cf1118f2/"/>
    <id>https://gzezfisher.top/2022/01/27/cf1118f2/</id>
    <published>2022-01-27T09:39:09.000Z</published>
    <updated>2022-01-27T13:59:36.317Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>给定一个有 $n$ 个节点的树，节点可能有颜色，共 $k$ 种颜色，编号 $1…k$，保证每种颜色都出现. 有的点没有颜色，用 $0$ 表示. 将其划分为 $k$ 个联通块，是每个联通块中有且仅有一种颜色，颜色为 $0$ 的节点可以在任意联通块中. 求有多少中划分的方案.<br>$2\le k\le n\le 3\times 10^5$，答案对 $998244353$ 取模.<br><span id="more"></span></p><h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>我们称将一个点划归一个有且仅有颜色 $c$ 的联通块为将这个点染上颜色 $c$</p><p>显然有一些点的染色是确定的，一些点可以染上多种颜色，其中所有颜色为 $c$ 的点与它们的LCA的路径上的点确定染上颜色 $c$，证明显然</p><p>我们先按照如下流程将这些颜色确定的点染色：</p><ol><li>找出同一颜色 $c$ 的点的LCA</li><li>依次从每个点开始往父亲上跳，一边跳一边染色</li><li>跳到一个点已经染色或已经到达LCA即可停止，如果跳到的点已经染上颜色且不为 $c$ 则两种颜色构成的联通块必然重叠，即没有合法方案</li></ol><p>接下来考虑树形DP<br>令 $f_{u,0}$ 表示在以 $u$ 为根的子树中，最上方联通块不包含已染色点的方案数，$f_{u,1}$ 表示在以 $u$ 为根的子树中，最上方联通块包含已染色点的方案数，$c_u$ 表示点 $u$ 的颜色</p><p>我们分两种情况讨论转移：</p><ol><li><p>$c_u\not=0$<br>显然 $f_{u, 0}=0$<br>对于 $f_{u, 1}$，再分情况讨论：</p><ol><li>$v\in\text{son}_u,c_v\not=0$<br>能够确定边 $(u, v)$ 是否删去，对 $f_{u, 1}$ 贡献为 $f_{v, 1}=f_{v, 0}+f_{v, 1}$</li><li>$v\in\text{son}_u,c_v=0$<br>若边 $(u, v)$ 删去，$v$ 所在联通块必须有色，否则该联通块将不包含任何一种颜色，对 $f_{u, 1}$ 贡献为 $f_{v, 1}$<br>若边 $(u, v)$ 保留，$v$ 所在联通块必须无色，否则该联通块将包含多种颜色，对 $f_{u, 1}$ 贡献为 $f_{v, 0}$<br>总贡献为 $f_{v, 0}+f_{v, 1}$</li></ol><p>综上，$f_{u, 1}=\prod\limits_{v\in\text{son}_u}f_{v, 0}+f_{v, 1}$</p></li><li>$c_u=0$<br>类似的，$f_{u, 0}=\prod\limits_{v\in\text{son}_u}f_{v, 0}+f_{v, 1}$<br>对于 $f_{u, 1}$，我们枚举 $u$ 继承哪一个儿子节点的颜色，即 $f_{u, 1}=\sum\limits_{v_1\in\text{son}_u}f_{v_1, 1}\times\prod\limits_{v_2\in\text{son}_u,v_2\not=v_1}f_{v_2, 0}+f_{v_2, 1}$<br>对于这条式子我们维护 $f_{v, 0}+f_{v, 1}$ 的前缀积和后缀积即可</li></ol><p>总的时间复杂度 $\Theta(n)$ 到 $\Theta(n\log n)$，取决于求LCA的算法</p><p>代码 <a href="http://codeforces.com/contest/1118/submission/143330738">codeforces submission 143330738</a></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;题意&quot;&gt;&lt;a href=&quot;#题意&quot; class=&quot;headerlink&quot; title=&quot;题意&quot;&gt;&lt;/a&gt;题意&lt;/h2&gt;&lt;p&gt;给定一个有 $n$ 个节点的树，节点可能有颜色，共 $k$ 种颜色，编号 $1…k$，保证每种颜色都出现. 有的点没有颜色，用 $0$ 表示. 将其划分为 $k$ 个联通块，是每个联通块中有且仅有一种颜色，颜色为 $0$ 的节点可以在任意联通块中. 求有多少中划分的方案.&lt;br&gt;$2\le k\le n\le 3\times 10^5$，答案对 $998244353$ 取模.&lt;br&gt;</summary>
    
    
    
    <category term="题解" scheme="https://gzezfisher.top/categories/%E9%A2%98%E8%A7%A3/"/>
    
    <category term="树" scheme="https://gzezfisher.top/categories/%E6%A0%91/"/>
    
    <category term="树形DP" scheme="https://gzezfisher.top/categories/%E6%A0%91/%E6%A0%91%E5%BD%A2DP/"/>
    
    
    <category term="树形DP" scheme="https://gzezfisher.top/tags/%E6%A0%91%E5%BD%A2DP/"/>
    
  </entry>
  
  <entry>
    <title>CF802O April Fools&#39; Problem (hard)</title>
    <link href="https://gzezfisher.top/2022/01/26/cf802o/"/>
    <id>https://gzezfisher.top/2022/01/26/cf802o/</id>
    <published>2022-01-26T14:20:22.000Z</published>
    <updated>2022-01-27T14:22:42.760Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>有 $n$ 道题，第 $i$ 天可以花费 $a_i$ 准备一道题，花费 $b_i$ 打印一道题，每天最多准备一道题，打印一道题，准备的题可以留到以后打印，求打印 $k$ 道题的最小花费.<br>$1\le k\le n\le 5\times10^5$<br><span id="more"></span></p><h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>显然可以费用流解决，建图如下.<br><img src="/img/cf802o/flow.svg" alt=""></p><p>考虑优化费用流</p><p><article class="message">  <div class="message-header">    <p>引理</p>  </div>  <div class="message-body">    初始不含负圈的图在费用流的增广过程中不会出现负圈  </div></article>根据引理得，每次增广的增广路都是一条形如 $S\rightarrow X\rightarrow Y\rightarrow T’\rightarrow T$ 的路径，一共增广 $k$ 次.</p><p>设 $f_i$ 表示在残流网络上 $i+1$ 点向 $i$ 的流量，则一条增广路合法当且仅当 $S\rightarrow X,Y\rightarrow T’$ 这两条边有流量且满足下列两个条件之一：</p><ol><li>$X\le Y$</li><li>$X&gt;Y\land \min_{Y\le i&lt;X}f_i&gt;0$</li></ol><p>我们尝试用线段树来模拟这一过程，对于每一个区间 $[l, r]$，维护 $a$ 的最小值计为 $ma$，$b$ 的最小值计为 $mb$，从 $x$ 到 $l$ 有流量的最小 $a_x$ 计为 $fa$，从 $r+1$ 到 $x$ 有流量的最小 $b_x$ 计为 $fb$，从左到右的最小费用流计为 $f1$，从右到左的最小费用流计为 $f2$，从 $r+1$ 到 $l$ 的流量计为 $f$</p><p>每找到一条增广路，在线段树上更新流量并把 $a_X,b_Y$ 赋值 $\text{Infinity}$ 以标记 $S\rightarrow X,Y\rightarrow T’$ 这两条边没有流量</p><p>这时候我们发现这个做法是不可行的，应为我们没法对流量快速地区间修改</p><p>发现 $f_n$ 的值总是 $0$，我们将 $fa$，$fb$ 和 $f2$ 的定义修改为<strong>在整个区间每条边的流量都减去 $f$ 时原定义的值</strong>，这样一来区间 $[1, n]$ (也就是我们需要查询的区间) 的值是符合原定义的，二来区间修改时我们只需要更新流量，每次增广的时间复杂度可以做到 $\Theta(\log n)$</p><p>总时间复杂度为 $\Theta(k\log n)$</p><p>代码 <a href="http://codeforces.com/contest/802/submission/143973639">codeforces submission 143973639</a></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;题意&quot;&gt;&lt;a href=&quot;#题意&quot; class=&quot;headerlink&quot; title=&quot;题意&quot;&gt;&lt;/a&gt;题意&lt;/h2&gt;&lt;p&gt;有 $n$ 道题，第 $i$ 天可以花费 $a_i$ 准备一道题，花费 $b_i$ 打印一道题，每天最多准备一道题，打印一道题，准备的题可以留到以后打印，求打印 $k$ 道题的最小花费.&lt;br&gt;$1\le k\le n\le 5\times10^5$&lt;br&gt;</summary>
    
    
    
    <category term="题解" scheme="https://gzezfisher.top/categories/%E9%A2%98%E8%A7%A3/"/>
    
    <category term="图论" scheme="https://gzezfisher.top/categories/%E5%9B%BE%E8%AE%BA/"/>
    
    <category term="网络流" scheme="https://gzezfisher.top/categories/%E5%9B%BE%E8%AE%BA/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
    <category term="数据结构" scheme="https://gzezfisher.top/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"/>
    
    <category term="线段树" scheme="https://gzezfisher.top/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
    
    <category term="网络流" scheme="https://gzezfisher.top/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
    <category term="线段树" scheme="https://gzezfisher.top/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91/"/>
    
  </entry>
  
  <entry>
    <title>CF997D Cycles in product</title>
    <link href="https://gzezfisher.top/2022/01/26/cf997d/"/>
    <id>https://gzezfisher.top/2022/01/26/cf997d/</id>
    <published>2022-01-26T11:30:05.000Z</published>
    <updated>2022-01-27T13:20:01.737Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>给你大小为 $n_1, n_2$​的两棵树 $T_1, T_2$​，构造一张新图，该图中每一个点的编号为 $(u,v)$。如果在 $T_1$ ​中， $u_1$ ​和$u_2$ ​之间有边，那么在该图上，对于任意 $1\le v\le n_2$，$(u_1, v)$ 和 $(u_2, v)$ 之间有边。同样，如果在 $T_2$ ​中，$v_1$ ​和$v_2$​之间有边，那么在图上，对于任意 $1\le u\le n_1$，$(u, v_1)$ 和 $(u, v_2)$ 之间有边.<br>求这个图上长度为 $K$ 的环有多少个，环可以不为简单环，起始点或方向不同的环视为不同的环.<br>$n_1, n_2\le 4000, K\le 75$，答案对 $998244353$ 取模.<br><span id="more"></span></p><h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>$T_1$ 上一个长度为 $K_1$ 的环和 $T_2$ 上一个长度为 $K_2$ 的环以不同方式组合对应图上 $\begin{pmatrix}K_1+K_2\\k_1\end{pmatrix}$ 个环<br>即答案为 $\sum\limits_{0\le i\le K}F1_i\times F2_{K-i}\times\begin{pmatrix}K\\i\end{pmatrix}$，其中 $F1_i$ 表示 $T_1$ 上长度为 $i$ 的环的个数，$F2_i$ 表示 $T_2$ 上长度为 $i$ 的环的个数</p><p>我们把每个点作为起始点分别计算，考虑到树上所有的环长度均为偶数，令 $f_{u, k}$ 表示以 $u$ 为起始点，长度为 $2\times k$ 的环的个数，有 $F_{2\times k}=\sum\limits_u f_{u, k}$<br>由于从父亲节点往儿子节点转移十分困难，不妨对于每个点只考虑在其子树中的环然后换根DP<br>考虑转移</p><script type="math/tex; mode=display">f_{u,k}=\sum_{0\le t<k}f_{u,t}\sum_{v\in \text{son}_u}f_{v,k-t-1}</script><p>令 $h_{u,k}=\sum_{v\in \text{son}_u}f_{v,k-t-1}$，有</p><script type="math/tex; mode=display">f_{u,k}=\sum_{0\le t<k}f_{u,t}\times h_{u, k-t-1}</script><p>换根DP维护 $h$，再通过 $h$ 计算 $f$<br>$\Theta((n_1+n_2)\times K^2)$ 足以通过此题</p><p>代码 <a href="http://codeforces.com/contest/997/submission/143516835">codeforces submission 143516835</a></p><h2 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h2><p>复杂度瓶颈在 $f$ 的计算，考虑优化这一过程</p><p>令 $h’_{u,k}=h_{u,k-1}$，有</p><script type="math/tex; mode=display">f_{u,k}=\sum_{0\le t<k}f_{u,t}\times h'_{u,k-t}</script><p>令$G_u(x)=\sum_{1\le i\le k}h’_{u,i}\times x^i$，有</p><script type="math/tex; mode=display">\begin{align*}f_{u,k}&=[x^k]\sum_{1\le i\le k}G_u(x)^i\\&=[x^k]\frac{G_u(x)^{k+1}-G_u(x)}{G_u(x)-1}\end{align*}</script><p>多项式快速幂和求逆可以做到 $\Theta((n_1+n_2)K\log K)$ 的复杂度</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;题意&quot;&gt;&lt;a href=&quot;#题意&quot; class=&quot;headerlink&quot; title=&quot;题意&quot;&gt;&lt;/a&gt;题意&lt;/h2&gt;&lt;p&gt;给你大小为 $n_1, n_2$​的两棵树 $T_1, T_2$​，构造一张新图，该图中每一个点的编号为 $(u,v)$。如果在 $T_1$ ​中， $u_1$ ​和$u_2$ ​之间有边，那么在该图上，对于任意 $1\le v\le n_2$，$(u_1, v)$ 和 $(u_2, v)$ 之间有边。同样，如果在 $T_2$ ​中，$v_1$ ​和$v_2$​之间有边，那么在图上，对于任意 $1\le u\le n_1$，$(u, v_1)$ 和 $(u, v_2)$ 之间有边.&lt;br&gt;求这个图上长度为 $K$ 的环有多少个，环可以不为简单环，起始点或方向不同的环视为不同的环.&lt;br&gt;$n_1, n_2\le 4000, K\le 75$，答案对 $998244353$ 取模.&lt;br&gt;</summary>
    
    
    
    <category term="题解" scheme="https://gzezfisher.top/categories/%E9%A2%98%E8%A7%A3/"/>
    
    <category term="树" scheme="https://gzezfisher.top/categories/%E6%A0%91/"/>
    
    <category term="树形DP" scheme="https://gzezfisher.top/categories/%E6%A0%91/%E6%A0%91%E5%BD%A2DP/"/>
    
    <category term="多项式" scheme="https://gzezfisher.top/categories/%E5%A4%9A%E9%A1%B9%E5%BC%8F/"/>
    
    
    <category term="树形DP" scheme="https://gzezfisher.top/tags/%E6%A0%91%E5%BD%A2DP/"/>
    
    <category term="多项式" scheme="https://gzezfisher.top/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>CF717A Festival Organization</title>
    <link href="https://gzezfisher.top/2022/01/26/cf717a/"/>
    <id>https://gzezfisher.top/2022/01/26/cf717a/</id>
    <published>2022-01-26T08:34:11.000Z</published>
    <updated>2022-01-27T13:19:42.057Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>一个合法的串定义为：长度在 $[l, r]$ 之间，且只含 $0,1$，并且不存在连续 $2$ 个或更多的 $0$.<br>现在要选出 $k$ 个长度相同的不同的合法的串，问有几种选法，答案模 $10^9+7$.<br>$1\le l\le r\le10^{18}, 1\le k\le200$.<br><span id="more"></span></p><h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><p>设 $F_{i,j}$ 表示长度为 $i$, 以 $j$ 结尾的合法串个数.<br>有 <script type="math/tex">\left\{      \begin{array}{**lr**}      F_{i,0}=F_{i-1,1} &  \\      F_{i,1}=F_{i-1,0}+F_{i-1,1} &     \end{array}  \right.</script><br>即 <script type="math/tex">\left\{      \begin{array}{**lr**}      F_{i,0}=\text{Fib}_{i} &  \\      F_{i,1}=\text{Fib}_{i+1} &     \end{array}  \right.</script><br>所以答案 <script type="math/tex">\text{Ans}=\sum\limits_{l+2\le i\le r+2}\begin{pmatrix}\text{Fib}_i\\k\end{pmatrix}</script></p><script type="math/tex; mode=display">\begin{align*}    \text{Ans}    =&\sum_{l+2\leq i\leq r+2} \begin{pmatrix}{\text{Fib}_i}\\k\end{pmatrix}\\    =&\frac{1}{k!}\sum_{l+2\le i\le r+2} {\text{Fib}_i}^{\underline{k}}\\    =&\frac{1}{k!}\sum_{l+2\le i\le r+2}\sum_{1\le j\le k}(-1)^{k-j}\begin{bmatrix}k\\ j \end{bmatrix}{\text{Fib}_i}^j\\    =&\frac{1}{k!}\sum_{1\le i\le k}(-1)^{k-i}\begin{bmatrix}k\\ i \end{bmatrix}\sum_{l+2\le j\le r+2}{\text{Fib}_j}^i\end{align*}</script><p>考虑带入斐波那契数的通项，令 $A=\frac{1+\sqrt{5}}{2}, B=\frac{1-\sqrt{5}}{2}$</p><script type="math/tex; mode=display">\begin{align*}    \text{Ans}    =&\frac{1}{k!}\sum_{1\le i\le k}(-1)^{k-i}\begin{bmatrix}k\\ i \end{bmatrix}\sum_{l+2\le j\le r+2}[{\frac{1}{\sqrt{5}}(A^j-B^j)}]^i\\    =&\frac{1}{k!}\sum_{1\le i\le k}(-1)^{k-i}\begin{bmatrix}k\\ i \end{bmatrix}(\frac{1}{\sqrt{5}})^i\sum_{l+2\le j\le r+2}\sum_{0\le p\le i}\begin{pmatrix}i\\p\end{pmatrix}(-1)^p(A^{i-p}B^p)^j\\    =&\frac{1}{k!}\sum_{1\le i\le k}(-1)^{k-i}\begin{bmatrix}k\\ i \end{bmatrix}(\frac{1}{\sqrt{5}})^i\sum_{0\le j\le i}\begin{pmatrix}i\\j\end{pmatrix}(-1)^j\sum_{l+2\le p\le r+2}(A^{i-j}B^j)^p\end{align*}</script><p>等比数列求和快速计算式子后面部分<br>$\Theta(k^2\times(\log l+\log r))$</p><h2 id="细节"><a href="#细节" class="headerlink" title="细节"></a>细节</h2><p>本题涉及对 $\sqrt{5}$ 的计算，然而在模 $10^9+7$ 意义下 $5$ 没有二次剩余，我们用扩域解决</p><p>代码 <a href="http://codeforces.com/contest/717/submission/137205589">codeforces submission 137205589</a></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;题意&quot;&gt;&lt;a href=&quot;#题意&quot; class=&quot;headerlink&quot; title=&quot;题意&quot;&gt;&lt;/a&gt;题意&lt;/h2&gt;&lt;p&gt;一个合法的串定义为：长度在 $[l, r]$ 之间，且只含 $0,1$，并且不存在连续 $2$ 个或更多的 $0$.&lt;br&gt;现在要选出 $k$ 个长度相同的不同的合法的串，问有几种选法，答案模 $10^9+7$.&lt;br&gt;$1\le l\le r\le10^{18}, 1\le k\le200$.&lt;br&gt;</summary>
    
    
    
    <category term="题解" scheme="https://gzezfisher.top/categories/%E9%A2%98%E8%A7%A3/"/>
    
    <category term="数学" scheme="https://gzezfisher.top/categories/%E6%95%B0%E5%AD%A6/"/>
    
    <category term="组合" scheme="https://gzezfisher.top/categories/%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88/"/>
    
    
    <category term="斯特林数" scheme="https://gzezfisher.top/tags/%E6%96%AF%E7%89%B9%E6%9E%97%E6%95%B0/"/>
    
    <category term="二项式定理" scheme="https://gzezfisher.top/tags/%E4%BA%8C%E9%A1%B9%E5%BC%8F%E5%AE%9A%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>UOJ450 复读机</title>
    <link href="https://gzezfisher.top/2021/10/16/uoj450/"/>
    <id>https://gzezfisher.top/2021/10/16/uoj450/</id>
    <published>2021-10-16T08:40:00.000Z</published>
    <updated>2022-01-27T13:58:33.892Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>$k$ 种球，每种个数必须是 $d$ 的倍数，共 $n$ 个，求排成一行的方案数.</p><p>$n\le 10^9, k\le 5\times10^5, d\le 3$，答案对 $19491001$ 取模.<br><span id="more"></span></p><h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><script type="math/tex; mode=display">\begin{align*}\text{Ans}&=n!\sum_{i_1 \ge 0,d\mid i_1}\frac{1}{i_1!}\sum_{0\le i_2,d\mid i_2}\frac{1}{i_2!}\cdots\sum_{0\le i_k,d\mid i_k}\frac{1}{i_k!}\\&=[x^n]n!(\sum_{i\ge 0,d\mid i}\frac{x^i}{i!})^k\\\end{align*}</script><script type="math/tex; mode=display">\begin{align*}\sum_{i\ge 0,d\mid i}\frac{x^i}{i!}&=\sum_{i\ge 0}\frac{x^i}{i!}\frac{1}{d}\sum_{0\le j < d}{\omega_d^j}^i& \text{单位根反演}\\&=\frac{1}{d}\sum_{0\le j < d}\sum_{i\ge 0}\frac{(x\omega_d^j)^i}{i!}\\&=\frac{1}{d}\sum_{0\le j < d}e^{x\omega_d^j}& \text{泰勒展开}\\\end{align*}</script><p>$d=2$：</p><script type="math/tex; mode=display">\begin{align*}\sum_{i\ge 0,d\mid i}\frac{x^i}{i!}&=\frac{1}{d}\sum_{0\le j < d}e^{x\omega_d^j}\\&=\frac{e^x+e^{-x}}{2}\\(\sum_{i\ge 0,d\mid i}\frac{x^i}{i!})^k&=n!(\frac{e^x+e^{-x}}{2})^k\\&=\frac{1}{2^k}\sum_{0\le i\le k}\begin{pmatrix}k\\i\end{pmatrix}e^{ix}e^{-x(k-i)} & \text{二项式定理}\\&=\frac{1}{2^k}\sum_{0\le i\le k}\begin{pmatrix}k\\i\end{pmatrix}e^{2ix-kx}\\\text{Ans}&=[x^n]n!(\sum_{i\ge 0,d\mid i}\frac{x^i}{i!})^k\\&=\frac{n!}{2^k}\sum_{0\le i\le k}\begin{pmatrix}k\\i\end{pmatrix}[x^n]e^{2ix-kx}\\&=\frac{n!}{2^k}\sum_{0\le i\le k}\begin{pmatrix}k\\i\end{pmatrix}\frac{(2i-k)^n}{n!} & \text{泰勒展开}\\&=\frac{1}{2^k}\sum_{0\le i\le k}\begin{pmatrix}k\\i\end{pmatrix}(2i-k)^n\end{align*}</script><p>$d=3$：</p><script type="math/tex; mode=display">\begin{align*}\sum_{i\ge 0,d\mid i}\frac{x^i}{i!}&=\frac{1}{d}\sum_{0\le j < d}e^{x\omega_d^j}\\&=\frac{e^x+e^{\omega_3x}+e^{\omega_3^2x}}{3}\\(\sum_{i\ge 0,d\mid i}\frac{x^i}{i!})^k&=n!(\frac{e^x+e^{\omega_3x}+e^{\omega_3^2x}}{3})^k\\&=\frac{1}{3^k}\sum_{0\le i\le k}\begin{pmatrix}k\\i\end{pmatrix}\sum_{0\le j\le k-i}\begin{pmatrix}k-i\\j\end{pmatrix}e^{ix}e^{j\omega_3x}e^{(k-i-j)\omega_3^2x} & \text{多项式定理}\\&=\frac{1}{3^k}\sum_{0\le i\le k}\sum_{0\le j\le k-i}\begin{pmatrix}k\\i\end{pmatrix}\begin{pmatrix}k-i\\j\end{pmatrix}e^{ix+j\omega_3x+k\omega_3^2x-i\omega_3^2x-j\omega_3^2x}\\\text{Ans}&=[x^n]n!(\sum_{i\ge 0,d\mid i}\frac{x^i}{i!})^k\\&=\frac{n!}{3^k}\sum_{0\le i\le k}\sum_{0\le j\le k-i}\begin{pmatrix}k\\i\end{pmatrix}\begin{pmatrix}k-i\\j\end{pmatrix}[x^n]e^{ix+j\omega_3x+k\omega_3^2x-i\omega_3^2x-j\omega_3^2x}\\&=\frac{n!}{3^k}\sum_{0\le i\le k}\sum_{0\le j\le k-i}\begin{pmatrix}k\\i\end{pmatrix}\begin{pmatrix}k-i\\j\end{pmatrix}\frac{(i+j\omega_3+k\omega_3^2-i\omega_3^2-j\omega_3^2)^n}{n!} & \text{泰勒展开}\\&=\frac{1}{3^k}\sum_{0\le i\le k}\sum_{0\le j\le k-i}\begin{pmatrix}k\\i\end{pmatrix}\begin{pmatrix}k-i\\j\end{pmatrix}(i+j\omega_3+k\omega_3^2-i\omega_3^2-j\omega_3^2)^n\end{align*}</script>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;题意&quot;&gt;&lt;a href=&quot;#题意&quot; class=&quot;headerlink&quot; title=&quot;题意&quot;&gt;&lt;/a&gt;题意&lt;/h2&gt;&lt;p&gt;$k$ 种球，每种个数必须是 $d$ 的倍数，共 $n$ 个，求排成一行的方案数.&lt;/p&gt;
&lt;p&gt;$n\le 10^9, k\le 5\times10^5, d\le 3$，答案对 $19491001$ 取模.&lt;br&gt;</summary>
    
    
    
    <category term="题解" scheme="https://gzezfisher.top/categories/%E9%A2%98%E8%A7%A3/"/>
    
    <category term="数学" scheme="https://gzezfisher.top/categories/%E6%95%B0%E5%AD%A6/"/>
    
    <category term="数论" scheme="https://gzezfisher.top/categories/%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA/"/>
    
    <category term="组合" scheme="https://gzezfisher.top/categories/%E6%95%B0%E5%AD%A6/%E7%BB%84%E5%90%88/"/>
    
    
    <category term="二项式定理" scheme="https://gzezfisher.top/tags/%E4%BA%8C%E9%A1%B9%E5%BC%8F%E5%AE%9A%E7%90%86/"/>
    
    <category term="单位根反演" scheme="https://gzezfisher.top/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9%E5%8F%8D%E6%BC%94/"/>
    
    <category term="泰勒展开" scheme="https://gzezfisher.top/tags/%E6%B3%B0%E5%8B%92%E5%B1%95%E5%BC%80/"/>
    
  </entry>
  
  <entry>
    <title>LOJ6241 性能优化</title>
    <link href="https://gzezfisher.top/2021/01/15/loj6241/"/>
    <id>https://gzezfisher.top/2021/01/15/loj6241/</id>
    <published>2021-01-15T15:01:00.000Z</published>
    <updated>2022-01-28T02:27:01.770Z</updated>
    
    <content type="html"><![CDATA[<h2 id="题意"><a href="#题意" class="headerlink" title="题意"></a>题意</h2><p>求 </p><script type="math/tex; mode=display">T = \sum_{1\le i\le n}\sum_{1\le j\le\lfloor \frac{n}{i} \rfloor}\sum_{1\le k\le j}[\gcd(j,k)=1]</script><p>多组数据<br><span id="more"></span><br>$n\le 10^{10^6}$</p><h2 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h2><script type="math/tex; mode=display">T = \sum_{1\le i\le n}\sum_{1\le j\le\lfloor \frac{n}{i} \rfloor}\varphi(j)</script><p>令</p><script type="math/tex; mode=display">\text{S}(n) = \sum_{1\le i\le n}\varphi(i)</script><p>则有</p><script type="math/tex; mode=display">\begin{align*}T &= \sum_{1\le i\le n}\text{S}(\lfloor \frac{n}{i} \rfloor) \\  &= \text{S}(n) + \sum_{2\le i\le n}\text{S}(\lfloor \frac{n}{i} \rfloor) \\\end{align*}</script><p>根据杜教筛，由 $\varphi*\text{I}=\text{Id}$，有</p><script type="math/tex; mode=display">\text{I}(1)\times \text{S}(n)=\sum_{1\le i\le n}\text{Id}(i)-\sum_{2\le i\le n}\text{S}(\lfloor\frac{n}{i}\rfloor)\times \text{I}(i)</script><p>即</p><script type="math/tex; mode=display">\text{S}(n)=\frac{n(n+1)}{2}-\sum_{2\le i\le n}\text{S}(\lfloor\frac{n}{i}\rfloor)</script><p>带回原式得</p><script type="math/tex; mode=display">\begin{align*}T=&\frac{n(n+1)}{2}-\sum_{2\le i\le n}\text{S}(\lfloor\frac{n}{i}\rfloor) + \sum_{2\le i\le n}\text{S}(\lfloor \frac{n}{i} \rfloor)\\=&\frac{n(n+1)}{2}\end{align*}</script>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;题意&quot;&gt;&lt;a href=&quot;#题意&quot; class=&quot;headerlink&quot; title=&quot;题意&quot;&gt;&lt;/a&gt;题意&lt;/h2&gt;&lt;p&gt;求 &lt;/p&gt;
&lt;script type=&quot;math/tex; mode=display&quot;&gt;T = \sum_{1\le i\le n}\sum_{1\le j\le\lfloor \frac{n}{i} \rfloor}\sum_{1\le k\le j}[\gcd(j,k)=1]&lt;/script&gt;&lt;p&gt;多组数据&lt;br&gt;</summary>
    
    
    
    <category term="题解" scheme="https://gzezfisher.top/categories/%E9%A2%98%E8%A7%A3/"/>
    
    <category term="数学" scheme="https://gzezfisher.top/categories/%E6%95%B0%E5%AD%A6/"/>
    
    <category term="数论" scheme="https://gzezfisher.top/categories/%E6%95%B0%E5%AD%A6/%E6%95%B0%E8%AE%BA/"/>
    
    
    <category term="杜教筛" scheme="https://gzezfisher.top/tags/%E6%9D%9C%E6%95%99%E7%AD%9B/"/>
    
  </entry>
  
</feed>
